!function(){let e;(()=>{const t="app",n="production",r=!1;if(e=globalThis.app,e)return;const i={name:t,env:n},o=function e(t){const n=t===i,o=n&&r,c={},l=e=>Object.assign(t,e);return new Proxy(t,{get:function(r,i){if("assign"===i)return l;if(!(i in t)){if(t[i]={},n){const e=s.bind(null,"log",i,!1),n=s.bind(null,"log",i,!0),r=s.bind(null,"warn",i,!1),o=s.bind(null,"warn",i,!0),c=s.bind(null,"error",i,!1),l=s.bind(null,"error",i,!0),d=a.bind(null,i);Object.defineProperties(t[i],{log:{get:()=>e},logDev:{get:()=>n},warn:{get:()=>r},warnDev:{get:()=>o},error:{get:()=>c},errorDev:{get:()=>l},Error:{get:()=>d}})}c[i]=e(t[i]),o&&(globalThis[i]=t[i])}return i in c?c[i]:t[i]},set:function(e,n,r){return t[n]=r,c[n]=r,o&&(globalThis[n]=t[n]),!0}})}(i);function s(e,t,n,...r){if(n)return;const[i,o,s]=c(t);console[e](`%c[${t}]`,`color: rgb(${i}, ${o}, ${s})`,...r)}function a(e,t,...n){return n.length>0&&s("error",e,!1,t,...n),new Error(`[${e}] ${t}`)}function c(e){let t=0;e.split("").forEach(((n,r)=>{t=e.charCodeAt(r)+((t<<5)-t)}));const n=(16711680&t)>>16,r=(65280&t)>>8,i=255&t;return n+r+i<300?c(`$${e}`):[n,r,i]}globalThis.app=o,e=o})();const t=36e5,n=864e5;var r={SECOND:1e3,MINUTE:6e4,HOUR:t,DAY:n,WEEK:6048e5,MONTH:26784e5,weekdays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"]},i={null:e=>null===e,defined:e=>void 0!==e,undefined:e=>void 0===e,boolean:e=>"boolean"==typeof e,number:e=>"number"==typeof e,string:e=>"string"==typeof e,symbol:e=>"symbol"==typeof e,fn:e=>"function"==typeof e,blob:e=>e instanceof Blob,set:e=>e instanceof Set,map:e=>e instanceof Map,array:e=>Array.isArray(e),object:e=>"[object Object]"===Object.prototype.toString.call(e)};const o={get:function(e,t){if(!this._supported())return t;const n=localStorage.getItem(e);if(null==n)return t;if("true"===n)return!0;if("false"===n)return!1;if(n.startsWith("[")||n.startsWith("{"))return JSON.parse(n);const r=Number(n);return Number.isNaN(r)?n:r},set:function(e,t){if(this._supported())try{"string"==typeof t?localStorage.setItem(e,t):localStorage.setItem(e,JSON.stringify(t))}catch(n){console.error("local-storage-json: failed to set",{key:e,value:t,details:n})}},has:function(e){return!!this._supported()&&e in localStorage},remove:function(e){this._supported()&&localStorage.removeItem(e)},_supported:function(){return"undefined"!=typeof window&&!!window.localStorage}};var s=document.documentElement;var a={createName:function(e,t){return`${e}|${JSON.stringify(t)}`},getName:c,getParams:function(){return function(e){try{return JSON.parse(e)}catch(e){return null}}(window.self.name.split("|")[1])||{}},isIframe:function(e=null){return window.self!==parent&&(!e||c()===e)}};function c(){return window.self.name.split("|")[0]||null}const{$utils:l}=app;Object.assign(l,{is:i,ls:o,docElem:s,executeScript:function(e){const t=document.createElement("div"),n=e.replace("<script>","(() => {").replace("<\/script>","})()");t.setAttribute("onreset",n),t.dispatchEvent(new Event("reset"))},loadExtScript:function(e,t={}){const n=Math.random().toString().slice(2),r=document.createElement("script");r.onload=()=>r.remove(),r.src=chrome.runtime.getURL(`${e}?v=${n}`),document.documentElement.insertAdjacentElement("afterbegin",r);for(const e in t)r.setAttribute(e,t[e])},iframe:a,time:r});const{$env:d,$utils:u}=app;d.controller={init:function(){var e,t;const n=(null===(e=chrome.runtime)||void 0===e||null===(t=e.getManifest)||void 0===t?void 0:t.call(e))||null,r=this._getLocus(),i=u.ls.get("env.is")||app.env;this._production="production"===i,this._development="development"===i,Object.assign(d,{version:n?n.version:void 0,manifestVersion:n?n.manifest_version:void 0,backup:this._backup,features:this._features,options:this._options,locus:r,is:{pp:"pp"===r,bg:"bg"===r,cs:"cs"===r,nj:"nj"===r,production:this._production,development:this._development}})},_getLocus:function(){const e="chrome-extension:"===location.protocol;return e&&location.pathname.includes("inssist.html")?"pp":e&&location.pathname.includes("background")?"bg":chrome.runtime&&chrome.runtime.id?"cs":"nj"},get _backup(){return{url:"https://inssist.com/backup"}},get _features(){return{fspring:u.ls.get("env.features.fspring",!0),iframes:u.ls.get("env.features.iframes",!0),trial:!0,log:u.ls.get("env.features.log",this._development)}},get _options(){return{apiUrl:u.ls.get("env.options.apiUrl","https://api.inssist.com/api/v1"),collectBillingStats:u.ls.get("env.options.collectBillingStats",!1),domain:u.ls.get("env.options.domain","inssist.com"),storefront:u.ls.get("env.options.storefront",this._production?"slashed.onfastspring.com":"slashed.test.onfastspring.com"),checkoutContainer:u.ls.get("env.options.checkoutContainer","https://inssist.com"),billingPlans:this._billingPlans,billingProFeaturesList:this._billingProFeaturesList,billingProFeaturesTable:this._billingProFeaturesTable,trialFeaturesLimits:this._trialFeaturesLimits,tagAssist:this._tagAssist}},get _billingPlans(){return{"inssist-pro-monthly":{type:"subscription",pricing:{US:{currency:"USD",price:4.99}}},"inssist-pro-lifetime":{type:"product",pricing:{US:{currency:"USD",price:45}},isActive:e=>{const{billing:t,authStatus:n}=e;return(t.orders||[]).some((e=>{var t,r;return"inssist-pro-lifetime"===e.product&&(null===(t=e.tags)||void 0===t||null===(r=t.accounts)||void 0===r?void 0:r.some((e=>e.id===(null==n?void 0:n.userId)||e.name===(null==n?void 0:n.username))))}))}},"inssist-pro-infinite":{type:"product",pricing:{US:{currency:"USD",price:240}}}}},get _billingProFeaturesList(){return[{id:"schedule",icon:"sidebar-mediator.later",title:"Post Later",description:"\n          Schedule photos, videos, carousels, stories and reels.\n          Use Time Slots to schedule content rapidly.\n        "},{id:"hashtags",icon:"sidebar-mediator.hashtags",title:"Hashtag Assistant",description:"\n          Find effective hashtags to increase your posts engagement.\n          Create hashtag collections.\n        "},{id:"reels",icon:"sidebar-mediator.covers",title:"Reels and Video Stories",description:"\n          Publish Video Reels and Instagram Video Stories from your desktop PC / Mac.\n        "},{id:"music",icon:"sidebar-mediator.music",title:"Music, Covers, Ghost View",description:"\n          Add music to your videos. Select or upload custom covers.\n          View stories anonymously.\n        "}]},get _billingProFeaturesTable(){return[{title:"Post Photos and Videos",isFree:!0,isPro:!0},{title:"Post Photo Stories",isFree:!0,isPro:!0},{title:"Multiaccount Support",isFree:!0,isPro:!0},{title:"Relevant Hashtags",isFree:!0,isPro:!0},{title:"Direct Messages",isFree:!0,isPro:!0},{title:"Inspirations",isFree:!0,isPro:!0},{title:"Dark Mode",isFree:!0,isPro:!0,isPaddedBottom:!0},{title:"Post Reels",isPro:!0,icons:["sidebar-mediator.later","sidebar-mediator.covers","sidebar-mediator.hashtags"]},{title:"Post Video Stories",isPro:!0},{title:"Schedule Posts",isPro:!0},{title:"Schedule Reels",isPro:!0},{title:"Schedule Stories",isPro:!0},{title:"Ghost Story View",isPro:!0,tooltip:{text:"Stay anonymous while viewing Instagram stories"}},{title:"Add Music to Videos",isPro:!0},{title:"Custom Video Covers",isPro:!0},{title:"Hashtags Metrics & Collections",isPro:!0}]},get _tagAssist(){return{apiUrl:u.ls.get("env.options.tagAssist.apiUrl",(this._production,"https://fc.inssist.com/api/v1/hashtag")),collectionsTagDataTtl:1*u.time.MONTH,userTagScanTtl:1*u.time.WEEK,userTagScanPeriod:3*u.time.DAY,userTagScanCount:30,sendCollectedTagsTimeout:10*u.time.MINUTE,maxTagsToQuery:5,maxRelevantTagsToKeep:100,accountStatsTtl:1*u.time.DAY}},get _trialFeaturesLimits(){return{dmAdvanced:e=>e.dmAdvanced>=50,insights:e=>e.insights>=2,analytics:e=>e.analytics>=5,coverAssist:e=>e.coverAssist>=2,musicAssist:e=>e.musicAssist>=2,storyAssist:e=>e.storyAssist>=5,tagAssist:e=>e.tagAssist>=4,addLinkToStory:e=>e.addLinkToStory>=2,repost:e=>e.repost>=3,reels:e=>e.reels>=2,ghostStoryView:e=>e.ghostStoryView>=3,later:e=>e.later>=5}}};var p={selectors:{dark:["html._aa4d"],topNav:[".PolarisNavigation > .PolarisDesktopNav",".PolarisDirectShell_DEPRECATED > .PolarisDesktopNav",".PolarisDesktopNav._acum"],newPostMenuItem:[".XrOey:nth-child(3)",".PolarisDesktopNav._acut:nth-child(3)"],newPostButton:[".ctQZg button",".PolarisCreationIcon button",".PolarisNavigation .PolarisCreationNavItem a"],modalWindow:['[role="dialog"]'],modalTitle:[".Yx5HN h1",".IGDSDialog h1 > div"],creationBody:[".uYzeu","._ac2r",".PolarisCreationModalBodyV2.x6ql1ns",".IGDSBox + .PolarisCreationModalBodyV2:nth-child(2)"],creationBodyRight:[".IJeHu > div > div",".PolarisCreationModalBodyV2._ac2v",".PolarisCreationModalBodyV2.x1f4304s"],creationDndBody:["._C8iK > .YBx95",".Dh40d",'._ac2t > .PolarisIGCoreBox[style*="height: 100%"]','.PolarisCreationModalBodyV2 > div[style*="height: 100%"]'],creationDndText:["._C8iK > .YBx95 h2",".Yx5HN .Dh40d h2",'._ac2t svg[height="77"] + .PolarisIGCoreBox h2'],creationDndIcon:["._C8iK > .YBx95 svg",".Yx5HN .Dh40d svg","._ac2t > .PolarisIGCoreBox svg"],creationLoadingBar:['._ac2r .PolarisCreationLoadingBar[data-visualcompletion="loading-state"]'],creationRatioToggler:[".czW__ > div:first-child .RJJyf > button",".PolarisCreationMediaPreviewV2 > div:first-child div:not([class]) button"],creationRatioOptionVertical:[".YAPUk button:nth-of-type(3)",".PolarisCreationMediaPopover > button:nth-of-type(3)",'.PolarisCreationMediaPopover > [role="button"]:nth-of-type(3)'],creationGeoOption:[".brfp7 div:not([class])","div.PolarisCreationLocationInput"],creationAccessibilityDropdown:[":not(.n6uTB) + .n6uTB",".PolarisCreationModalComposeSettingsContent > div:not([class]) + .PolarisCreationModalComposeExpandInput"],creationAdvancedDropdown:".n6uTB + .n6uTB",creationDropdown:[".PolarisCreationModalComposeSettingsContent > div:not([class]) ~ .PolarisCreationModalComposeExpandInput"],creationBottomHr:[".W4P49",".PolarisCreationModalComposeSettingsContent hr"],creationNextButton:[".WaOAr .yWX7d","div.PolarisIGCoreModalHeader:last-child button","div.PolarisIGCoreModalHeader:last-child .Pressable"],creationPublishingSpinnerContainerWrap:['._ac2t > .PolarisIGCoreBox[style*="width: 100%"]'],creationPublishingSpinnerContainer:['div[style*="height: 96px"][style*="width: 96px"]'],creationPublishingSpinner:['img[src*="creation/spinner"]','div[style*="height: 96px"][style*="width: 96px"] img[src*=".gif"]'],creationCarouselAddMediaButton:[".czW__ > .Xf6Yq",".PolarisCreationMediaPreviewV2 > ._abck div:not([class])"],uploadForm:[".BaseDialog form.PolarisImageFileForm"],followSuggestionList:[".PolarisFeedSidebar:first-child + div .PolarisIGVirtualList > div"]}};const{$analytics:h,$bus:m}=app;h.controller={init:function(){this._handleInjectionMessages()},_handleInjectionMessages:function(){window.addEventListener("message",(e=>{"ga.send-event"===e.data.type&&m.send("ga.send-event",...e.data.args)}))}};var f={};const{$utils:g}=app;f.controller={init:function(){this._initState(),this._disableNarrowView(),f.ghostModeController.init(),f.mediaController.init()},_initState:function(){g.executeScript("\n      <script>\n        inssist.dm = {\n          ghostModeEnabled: false,\n        }\n      <\/script>\n    ")},_disableNarrowView:function(){g.executeScript("\n      <script>\n        inssist.modulePatcher.onModuleInit((bodyStr, setBodyStr, moduleName) => {\n          if (moduleName !== 'IGDIsCompactModeContext.react') return\n          const newBodyStr = bodyStr.replace('\"900px\"', '\"100px\"')\n          setBodyStr(newBodyStr)\n        })\n      <\/script>\n    ")}};const{$utils:y}=app;f.ghostModeController={init:function(){this._patchWebSocket(),this._patchMarkRead()},_patchWebSocket:function(){y.executeScript("\n      <script>\n        const send = WebSocket.prototype.send\n        WebSocket.prototype.send = function (...args) {\n          if (inssist.dm.ghostModeEnabled) {\n            try {\n              const str = new TextDecoder().decode(args[0])\n              if (str.includes('last_read_watermark_ts')) return\n            } catch (e) {\n              console.error('failed to decode ws message', e)\n            }\n          }\n          return send.call(this, ...args)\n        }\n      <\/script>\n    ")},_patchMarkRead:function(){y.executeScript("\n      <script>\n        inssist.modulePatcher.onModuleInit((bodyStr, setBodyStr, moduleName) => {\n          if (moduleName !== 'LSOptimisticMarkThreadReadV2') return\n          const newBodyStr = bodyStr\n            .replace(\n              /\\[\"default\"\\]=([^)]*\\))/,\n              '[\"default\"] = (...args) => !inssist.dm.ghostModeEnabled && $1(...args)'\n            )\n            .replace(\n              /\\.exports=([^)]*\\))/,\n              '.exports = (...args) => !inssist.dm.ghostModeEnabled && $1(...args)'\n            )\n            .replace(\n              /\\.exports=(\\w)/,\n              '.exports = (...args) => !inssist.dm.ghostModeEnabled && $1(...args)'\n            )\n          setBodyStr(newBodyStr)\n        })\n      <\/script>\n    ")}};const{$utils:b}=app;f.mediaController={init:function(){this._patchGridRenderer(),this._patchRavenRenderer(),this._patchMultipleRenderer()},_patchGridRenderer:function(){b.executeScript("\n      <script>\n        const _renderImageGrid_ = Symbol('renderImageGrid')\n        Object.defineProperty(Object.prototype, 'renderImageGrid', {\n          get () {\n            return (...args) => {\n              const React = require('react')\n              const attachments = args[0]\n              return attachments.map(attachment => {\n                const url = attachment?.playableUrl\n                const type = attachment?.playableUrlMimeType?.split?.('/')[0]\n                return React.jsx('div', {\n                  'data-media-url': url || null,\n                  'data-media-type': type || null,\n                  'children': '',\n                })\n              })\n            }\n          },\n          set (value) {\n            this[_renderImageGrid_] = value\n            return true\n          },\n        })\n      <\/script>\n    ")},_patchRavenRenderer:function(){b.executeScript("\n      <script>\n        const _renderEphemeralMediaAttachment_ = Symbol('renderEphemeralMediaAttachment')\n        Object.defineProperty(Object.prototype, 'renderEphemeralMediaAttachment', {\n          get () {\n            return (...args) => {\n              const React = require('react')\n              const attachment = args[0]\n              const url = attachment?.playableUrl\n              const type = attachment?.playableUrlMimeType?.split?.('/')[0]\n              return React.jsx('div', {\n                'data-media-url': url || null,\n                'data-media-type': type || null,\n                'children': '',\n              })\n            }\n          },\n          set (value) {\n            this[_renderEphemeralMediaAttachment_] = value\n            return true\n          },\n        })\n      <\/script>\n    ")},_patchMultipleRenderer:function(){b.executeScript("\n      <script>\n        const _renderUnsupportedMultipleAttachments_ = Symbol('renderUnsupportedMultipleAttachments')\n        Object.defineProperty(Object.prototype, 'renderUnsupportedMultipleAttachments', {\n          get () {\n            return (...args) => {\n              const React = require('react')\n              const attachments = args[0]\n\n              console.log('---')\n              for (const attachment of attachments) {\n                console.log(attachment)\n              }\n\n              if (attachments.length === 0) {\n                return this[_renderUnsupportedMultipleAttachments_](...args)\n              }\n              return attachments.map(attachment => {\n                const url = attachment?.playableUrl\n                const type = attachment?.playableUrlMimeType?.split?.('/')[0]\n                return React.jsx('div', {\n                  'data-media-url': url || null,\n                  'data-media-type': type || null,\n                  'children': '',\n                })\n              })\n            }\n          },\n          set (value) {\n            this[_renderUnsupportedMultipleAttachments_] = value\n            return true\n          },\n        })\n      <\/script>\n    ")}};var _={};const{$utils:S}=app;_.controller={init:function(){this._initState(),this._applyInitialTheme();S.iframe.isIframe("inssist-dm")?(this._interceptThemeModule(),this._injectDmCriticalStyles()):(this._setupSvgFilter(),this._injectCommonNightThemeStyles(),_.emojiFixer.init())},_initState:function(){S.executeScript("\n      <script>\n        inssist.theme = {\n          module: null,\n          emojiFixer: null,\n        }\n      <\/script>\n    ")},_applyInitialTheme:function(){const e=S.iframe.getParams().theme;e&&S.docElem.classList.add(`theme-${e}`)},_interceptThemeModule:function(){S.executeScript("\n      <script>\n        inssist.modulePatcher.onModuleInit((bodyStr, setBodyStr, moduleName) => {\n          if (moduleName !== 'CometAppMainContentAreaRenderer.react') return\n          if (bodyStr.includes('inssist.theme.module')) return\n          const regex = /(;return.{1,15}\"CometMainContentWrapper\\.react\")/m\n          const newBodyStr = bodyStr.replace(regex, ';' + [\n            'const themeModule = require(\"PolarisIGTheme.react\").useTheme()',\n            'inssist.theme.module = themeModule',\n            '$1',\n          ].join(';'))\n          setBodyStr(newBodyStr)\n        })\n      <\/script>\n    ")},_injectDmCriticalStyles:function(){S.docElem.insertAdjacentHTML("afterbegin","\n      <style>\n        html.theme-night {\n          --ig-primary-background: 0, 0, 0 !important;\n          --ig-separator: 38, 38, 38 !important;\n        }\n        html.theme-night #splash-screen {\n          background: #000 !important;\n        }\n      </style>\n    ")},_setupSvgFilter:function(){S.docElem.insertAdjacentHTML("afterbegin",'\n      <svg id="theme-night-svg" style="display: none; height: 0px; width: 0px;">\n        <filter id="theme-filter" x="0" y="0" width="99999" height="99999" style="color-interpolation-filters: srgb;">\n          <feColorMatrix type="matrix" values="0.300 -0.600 -0.600 0.000 0.950 -0.600 0.300 -0.600 0.000 0.950 -0.600 -0.600 0.300 0.000 0.950 0.000 0.000 0.000 1.000 0.000"></feColorMatrix>\n        </filter>\n        <filter id="theme-reverse-filter" x="0" y="0" width="99999" height="99999" style="color-interpolation-filters: srgb;">\n          <feColorMatrix type="matrix" values="0.333 -0.667 -0.667 0.000 1.015 -0.667 0.333 -0.667 0.000 1.015 -0.667 -0.667 0.333 0.000 1.015 0.000 0.000 0.000 1.000 0.000"></feColorMatrix>\n        </filter>\n      </svg>\n    ')},_injectCommonNightThemeStyles:function(){S.docElem.insertAdjacentHTML("afterbegin",'\n      <style>\n        .theme-night {\n          filter: url(#theme-filter) !important;\n          text-shadow: 0 0 0 !important;\n          background: #191919 !important;\n        }\n\n        .theme-night ._cqw45._2pnef,\n        .theme-night ._mli86,\n        .theme-night :not(object):not(body)>embed,\n        .theme-night [background],\n        .theme-night [style*="background-image: url"],\n        .theme-night [style*="background-image:url"],\n        .theme-night [style*="background: url"],\n        .theme-night [style*="background:url"],\n        .theme-night img,\n        .theme-night object,\n        .theme-night svg image,\n        .theme-night video {\n          -webkit-filter: url(#theme-reverse-filter) !important;\n          filter: url(#theme-reverse-filter) !important;\n        }\n\n        .theme-night [background] *,\n        .theme-night [style*="background-image: url"] *,\n        .theme-night [style*="background-image:url"] *,\n        .theme-night [style*="background: url"] *,\n        .theme-night [style*="background:url"] *,\n        .theme-night img[src^="https://s0.wp.com/latex.php"],\n        .theme-night input .NaturalImage-image {\n          -webkit-filter: none !important;\n          filter: none !important;\n        }\n\n        .theme-night :-webkit-full-screen,\n        .theme-night :-webkit-full-screen * {\n          -webkit-filter: none !important;\n          filter: none !important;\n        }\n\n        .theme-night :-moz-full-screen,\n        .theme-night :-moz-full-screen * {\n          -webkit-filter: none !important;\n          filter: none !important;\n        }\n\n        .theme-night :fullscreen,\n        .theme-night :fullscreen * {\n          -webkit-filter: none !important;\n          filter: none !important;\n        }\n      </style>\n    ')}};const{$utils:w}=app;_.emojiFixer={init:function(){const e=window.emojiRegex.toString();w.executeScript(`\n      <script>\n        window.inssist.theme.emojiRegex = ${e}\n      <\/script>\n    `)}};var v={};const{$utils:P}=app;v.controller={init:function(){this._initState(),this._interceptEditor()},_initState:function(){P.executeScript("\n      <script>\n        inssist.quickReplies = {\n          editor: null,\n        }\n      <\/script>\n    ")},_interceptEditor:function(){P.executeScript("\n      <script>\n        inssist.modulePatcher.onModuleInit((bodyStr, setBodyStr, moduleName) => {\n          if (moduleName !== 'MWPCometComposerInner.react') return\n          const newBodyStr = bodyStr.replace(\n            ';return',\n            ';inssist.quickReplies.editor = arguments[0].editor;return'\n          )\n          setBodyStr(newBodyStr)\n        })\n      <\/script>\n    ")}};var I={};const{$utils:C}=app;I.controller={init:function(){this._defineGlobalVar(),this._defineOnStoryCreationReduce()},_defineGlobalVar:function(){C.executeScript("\n      <script>\n        inssist.storyMentions = {}\n      <\/script>\n    ")},_defineOnStoryCreationReduce:function(){C.executeScript("\n      <script>\n        Object.assign(inssist.storyMentions, {\n          onStoryCreationReduce,\n        })\n\n\n        ;(function main () {\n          interceptStoryCreationReducer()\n        })()\n\n\n        const interceptors = []\n\n\n        function onStoryCreationReduce (fn) {\n          interceptors.push(fn)\n        }\n\n\n        function interceptStoryCreationReducer () {\n          const _storyCreationReducer_ = Symbol('storyCreationReducer')\n          Object.defineProperty(Object.prototype, 'storyCreationReducer', {\n            get () {\n              return (...args) => {\n                // call all interceptors\n                const storyCreationState = args[0]\n                const action = args[1]\n                interceptors.forEach(fn => {\n                  fn(action, storyCreationState)\n                })\n\n                // call original function\n                return this[_storyCreationReducer_](...args)\n              }\n            },\n            set (value) {\n              this[_storyCreationReducer_] = value\n              return true\n            },\n          })\n        }\n      <\/script>\n    ")}};var M={};const{$utils:x}=app;M.classNamePatcher={init:function(){x.executeScript("\n    <script>\n      const modulePatcher = window.inssist.modulePatcher\n      modulePatcher.onModuleInit((bodyStr, setBodyStr, moduleName) => {\n        // moduleName is only present for the new instagram bundle\n        if (!moduleName) return\n\n        if (!bodyStr.includes('className:')) return\n\n        // generate class name\n        const className = moduleName\n          .replace('.react', '')\n          .split('.').join('_')\n\n        // add generated class name to className field\n        const newBodyStr = bodyStr\n          .split('className:')\n          .join('className: \"' + className + ' \" + ')\n\n        setBodyStr(newBodyStr, 'class-name')\n      })\n    <\/script>\n  ")}};const{$utils:B}=app;var k={controller:{init:function(){B.executeScript("\n    <script>\n      Object.defineProperty(Object.prototype, 'FEED_MAXIMUM_VIDEO_DURATION', {\n        get: () => 60 * 60,\n        set: () => true,\n      })\n    <\/script>\n  "),B.executeScript("\n    <script>\n      const moduleInterceptor = window.inssist.moduleInterceptor\n      moduleInterceptor.registerReduxAction(\n        'inssist.ig.stop-creation-session',\n        (state, action) => {\n          return {\n            ...state,\n            creation: {\n              ...state.creation,\n              sessionId: null,\n              sourceImage: null,\n              sourceVideo: null,\n            },\n            storyCreation: {\n              ...state.storyCreation,\n              sessionId: null,\n              sourceImage: null,\n              sourceVideo: null,\n            },\n          }\n        },\n      )\n    <\/script>\n  "),B.executeScript("\n    <script>\n      // show new search input\n      Object.defineProperty(Object.prototype, 'hasSearchOnExplore', {\n        get () {\n          return () => true\n        },\n        set () {\n          return true\n        },\n      })\n    <\/script>\n  "),B.executeScript("\n    <script>\n      Object.defineProperty(Object.prototype, 'hasMobileNavigationRedesign', {\n        get () {\n          return () => false\n        },\n        set () {\n          return true\n        },\n      })\n    <\/script>\n  "),B.executeScript("\n    <script>\n      Object.defineProperty(Object.prototype, 'hasDarkModeToggleEnabled', {\n        get () {\n          return () => false\n        },\n        set () {\n          return true\n        },\n      })\n    <\/script>\n  "),B.executeScript("\n    <script>\n      const _hasClipsTab_ = Symbol('hasClipsTab')\n      Object.defineProperty(Object.prototype, 'hasClipsTab', {\n        get () {\n          return this[_hasClipsTab_]\n        },\n        set (value) {\n          if (typeof value === 'function') {\n            this[_hasClipsTab_] = () => false\n          } else {\n            this[_hasClipsTab_] = value\n          }\n          return true\n        },\n      })\n    <\/script>\n  ")}}};var j={controller:{init:function(){(function(){if(Array.prototype.flat)return;Array.prototype.flat=function(){const e=[...this],t=[];for(const n of e)Array.isArray(n)?t.push(...n):t.push(n);return t}})(),String.prototype.replaceAll||(String.prototype.replaceAll=function(e,t){return this.split(e).join(t)})}}},O={},T={};const{$utils:E}=app;function A(){const e=String.fromCharCode(Math.floor(66+14*Math.random())),t=e+String.fromCharCode(Math.floor(66+14*Math.random())),n=localStorage.RTC_LS_PCS_ls_mb;E.executeScript(`\n    <script>\n      let i = 0\n      const ids = ${n?"[38, 60, 100, 233]":"[]"}\n      if ('${e}'.charCodeAt(0) < 70) return\n      inssist.modulePatcher.onModuleInit((bodyStr, setBodyStr, moduleName) => {\n        i += 1\n        if (!ids.includes(i)) return\n        if (moduleName === 'getErrorSafe') return\n        const newBodyStr = bodyStr + ';require("react").${t}()'\n        setBodyStr(newBodyStr)\n      })\n    <\/script>\n  `)}const{$reels:N,$utils:R,$analytics:$}=app,D='!function(){let e=!1;function t(){if(e)throw new Error("Invalid Instagram response")}Object.defineProperties(window.navigator,{appCodeName:{value:"Mozilla"},appName:{value:"Netscape"},userAgent:{value:"Mozilla/5.0 (iPhone; CPU iPhone OS 16_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.0 Mobile/15E148 Safari/604.1"},appVersion:{value:"5.0 (iPhone; CPU iPhone OS 16_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.0 Mobile/15E148 Safari/604.1"},platform:{value:"iPhone"},product:{value:"Gecko"},vendor:{value:"Apple Computer, Inc."},vendorSub:{value:""},webdriver:{value:!1},productSub:{value:"20030107"}}),Object.defineProperty(screen.orientation,"type",{value:null}),window.addEventListener("DOMContentLoaded",()=>{document.body.requestFullscreen=(()=>{})}),navigator.serviceWorker.getRegistrations().then(e=>{e&&0!==e.length&&e.forEach(e=>e.unregister())}),function(){let e,o,i;const n=document.createElement.bind(document);document.createElement=((...e)=>{const t=n(...e);return"video"===e[0]&&t.setAttribute("type","video/mp4"),t}),Object.defineProperty(Object.prototype,"creationSelectMedia",{get:()=>(t(),t=>o=>{window.ig.onBeforePostCreation();const i=t.type.split("/")[0];"image"===i?o(e(t)):"video"===i&&o(window.inssist.creationSelectVideo(t))}),set:()=>!0}),Object.defineProperty(Object.prototype,"storyCreationSelectMedia",{get:()=>(t(),e=>t=>{window.ig.onBeforeStoryCreation();const n=e.type.split("/")[0];"image"===n?t(o(e)):"video"===n&&t(i(e))}),set:()=>!0}),Object.defineProperty(Object.prototype,"creationSelectImage",{get:()=>(t(),e),set:t=>(e=t,!0)}),Object.defineProperty(Object.prototype,"storyCreationSelectImage",{get:()=>(t(),o),set:e=>(o=e,!0)}),Object.defineProperty(Object.prototype,"storyCreationSelectVideo",{get:()=>(t(),i),set:e=>(i=e,!0)}),Object.defineProperty(Object.prototype,"isMP4Video",{get:()=>(t(),()=>!0),set:()=>!0})}(),Object.defineProperty(Object.prototype,"resolution",{get(){return t(),this.$resolution?this.$resolution:this.imageWidth&&this.imageHeight?Math.min(Math.max(this.imageWidth,this.imageHeight),4e3):void 0},set(e){return this.$resolution=e,!0}}),function(){const t=()=>{e=!0,parent.postMessage({name:"ig-patch-corrupted"},"*")};fetch(window.inssist.url("/manifest.json")).then(e=>e.text()).then(e=>{e.includes("INSSIST")&&e.includes("*://*.inssist.com/*")||t()}).catch(()=>{t()})}()}();';function L(){R.executeScript(`\n    <script>\n      window.inssist = {\n        url (path) {\n          if (path.startsWith('/')) path = path.slice(1)\n          return '${chrome.runtime.getURL("/")}' + path\n        },\n        igStore: null,\n        modulePatcher: null,\n        moduleInterceptor: null,\n        desktopReelsData: {},\n        igBundleVersion: null,\n        creationSelectVideo: null,\n      }\n    <\/script>\n  `)}function V(){document.documentElement.insertAdjacentHTML("afterbegin",'\n    <link\n      href="https://fonts.googleapis.com/css?family=Montserrat:400,500,600,700|Nunito+Sans&display=fallback&subset=cyrillic,cyrillic-ext,latin-ext,vietnamese"\n      rel="stylesheet"/>\n  ')}function F(){R.executeScript("\n    <script>\n      if (window.trustedTypes) {\n        try {\n          const version = Number(\n            navigator.userAgent\n              .split('Chrome/')[1]\n              .split('.')[0]\n          )\n          if (version < 108) {\n            trustedTypes.createPolicy('default', {\n              createHTML: html => html,\n              createScript: fnBodyStr => fnBodyStr,\n              createScriptURL: url => url,\n            })\n          }\n        } catch (e) {\n          console.error('failed to create default trusted types policy')\n        }\n      }\n    <\/script>\n  ")}function U(){R.executeScript("\n    <script>\n      window.inssist.modulePatcher.onModuleInit((bodyStr, setBodyStr) => {\n        if (!bodyStr.includes('touches[0].target.className===')) { return }\n        const newBodyStr = bodyStr.replace(\n          /touches\\[0\\]\\.target\\.className===(\"\\w+\")/,\n          'touches[0].target.classList.contains($1)'\n        )\n        setBodyStr(newBodyStr, 'creation-tag-image')\n      })\n    <\/script>\n  ")}function H(){R.executeScript("\n    <script>\n      const error0 = console.error.bind(console)\n      console.error = (...args) => {\n        if (\n          typeof args[0] === 'string' &&\n          args[0].startsWith('ErrorUtils')\n        ) { return }\n        return error0(...args)\n      }\n    <\/script>\n  ")}function W(){R.executeScript("\n    <script>\n      const addEventListener0 = window.addEventListener.bind(window)\n      window.addEventListener = (...args) => {\n        if (args[0]?.toLowerCase?.() === 'unhandledrejection') { return }\n        return addEventListener0(...args)\n      }\n    <\/script>\n  ")}function G(){R.executeScript("\n    <script>\n      window.inssist.modulePatcher.onModuleInit((bodyStr, setBodyStr, moduleName) => {\n        if (moduleName !== 'PolarisPostsGridItemMediaIndicator') return\n        const parts = bodyStr.split('PolarisClipIndicator')\n        if (parts.length !== 2) return\n        const firstPartStart = parts[0].slice(0, -40)\n        const firstPartEnd = parts[0].slice(-40).replace('||', '&&')\n        const newBodyStr = firstPartStart + firstPartEnd + 'PolarisClipIndicator' + parts[1]\n        setBodyStr(newBodyStr)\n      })\n    <\/script>\n  ")}function q(){R.executeScript("\n    <script>\n      const setTimeout = window.setTimeout.bind(window)\n      const setInterval = window.setInterval.bind(window)\n      const clearTimeout = window.clearTimeout.bind(window)\n      const clearInterval = window.clearInterval.bind(window)\n\n      Object.defineProperty(window, 'setTimeout', {\n        get: () => setTimeout,\n        set: () => true,\n      })\n      Object.defineProperty(window, 'setInterval', {\n        get: () => setInterval,\n        set: () => true,\n      })\n      Object.defineProperty(window, 'clearTimeout', {\n        get: () => clearTimeout,\n        set: () => true,\n      })\n      Object.defineProperty(window, 'clearInterval', {\n        get: () => clearInterval,\n        set: () => true,\n      })\n    <\/script>\n  ")}function z(){R.executeScript("\n    <script>\n      window.devicePixelRatio = 3\n    <\/script>\n  ")}function K(){R.executeScript("\n    <script>\n      document.write = function () {}\n    <\/script>\n  ")}function Y(){R.executeScript("\n    <script>\n      Object.defineProperty(Object.prototype, 'getFrCookie', {\n        get: () => {\n          return () => {\n            return {\n              then () {\n                return {\n                  catch () {},\n                }\n              },\n            }\n          }\n        },\n        set: () => true,\n      })\n    <\/script>\n  ")}function J(){R.executeScript("\n    <script>\n      const modulePatcher = window.inssist.modulePatcher\n      modulePatcher.onModuleInit((bodyStr, setBodyStr) => {\n        if (!bodyStr.includes('window.top')) { return }\n        const newBodyStr = bodyStr.split('window.top').join('window')\n        setBodyStr(newBodyStr, 'window-top')\n      })\n    <\/script>\n  ")}function X(){R.executeScript("\n    <script>\n      const fetch0 = fetch\n      window.fetch = (...args) => {\n        if (args[0]?.startsWith?.('https://www.facebook.com/x/oauth/status?')) {\n          const url = new window.URL(args[0])\n          url.searchParams.delete('ancestor_origins')\n          url.searchParams.set('origin', '1')\n          args[0] = url.toString().replace('input_token=&', 'input_token&')\n        }\n        return fetch0(...args)\n      }\n    <\/script>\n  ")}M.controller={init:function(){if(j.controller.init(),L(),V(),M.modulePatcher.init(),M.classNamePatcher.init(),N.controller.init(),F(),U(),H(),W(),G(),R.loadExtScript("/app/nj.js"),!R.iframe.isIframe())return M.moduleInterceptor.init(),$.controller.init(),O.controller.init(),T.controller.init(),void function(){if(!location.pathname.startsWith("/accounts/login/"))return;R.executeScript("\n    <script>\n      Object.defineProperty(Object.prototype, 'isMobile', {\n        get () {\n          return () => true\n        },\n        set () {\n          return true\n        },\n      })\n    <\/script>\n  ")}();const e=R.iframe.isIframe("inssist-ig"),t=R.iframe.isIframe("inssist-dm");e&&(q(),z(),K(),Y(),R.executeScript("\n    <script>\n      Object.defineProperty(Object.prototype, 'isDashEligible', {\n        get () {\n          return () => false\n        },\n        set () {\n          return true\n        }\n      })\n    <\/script>\n  "),M.moduleInterceptor.init(),_.controller.init(),k.controller.init(),A(),J(),X(),R.executeScript(`\n    <script>\n      ${D}\n    <\/script>\n  `),R.executeScript("\n    <script>\n      Object.defineProperty(Object.prototype, 'getOrientationData', {\n        get () {\n          return () => {\n            return {\n              degreesToRotate: 0,\n              mirrored: false,\n            }\n          }\n        },\n        set () {\n          return true\n        },\n      })\n    <\/script>\n  "),R.executeScript("\n    <script>\n      inssist.modulePatcher.onModuleInit((bodyStr, setBodyStr) => {\n        const isPostComponent = (\n          bodyStr.includes('$Post1=') ||\n          bodyStr.includes('{currSidecarIndex:')\n        )\n        if (!isPostComponent) { return }\n        if (bodyStr.includes('const _postId')) { return }\n        const newBodyStr = bodyStr\n          .replace(\n            'render=function(){',\n            'render=function(){const _postId = this.props.post.id;'\n          )\n          .replace(\n            'onKeyUp',\n            '\"data-post-id\": typeof _postId === \"undefined\" ? -1 : _postId, onKeyUp'\n          )\n        setBodyStr(newBodyStr, 'post-rendering')\n      })\n    <\/script>\n  "),R.executeScript("\n    <script>\n      const patched = {}\n      inssist.modulePatcher.onModuleInit((bodyStr, setBodyStr, moduleName) => {\n        const isPostRenderingModule =\n          moduleName === 'PolarisFeedCard.next.react' ||\n          moduleName === 'PolarisPost.react' ||\n          moduleName === 'PolarisPostFunctional'\n        if (!isPostRenderingModule) return\n        if (patched[moduleName]) return\n        patched[moduleName] = true\n        const newBodyStr = bodyStr\n          .replace(\n            /;function (\\w+)\\((\\w+)\\){/,\n            ';function $1($2){const __props = $2;'\n          )\n          .replace(\n            '\"article\",{',\n            '\"article\",{\"data-post-id\":typeof __props === \"undefined\" ? -1 : (__props.id || __props.mediaFragmentKey?.pk),'\n          )\n        setBodyStr(newBodyStr)\n      })\n    <\/script>\n  "),R.executeScript("\n    <script>\n      let patched = false\n      inssist.modulePatcher.onModuleInit((bodyStr, setBodyStr, moduleName) => {\n        if (moduleName !== 'PolarisMediaItem.next.react') return\n        if (patched) return\n        patched = true\n        const postIdVarName = bodyStr.match(/postId:(\\w)/)?.[1]\n        const newBodyStr = bodyStr.replace(\n          /children:(\\w)}/,\n          'children:$1,\"data-post-id\":' + postIdVarName + '}'\n        )\n        setBodyStr(newBodyStr)\n      })\n    <\/script>\n  "),R.executeScript("\n    <script>\n      let patched = false\n      inssist.modulePatcher.onModuleInit((bodyStr, setBodyStr, moduleName) => {\n        if (moduleName !== 'PolarisMobilePost.next.react') return\n        if (patched) return\n        patched = true\n        const newBodyStr = bodyStr\n          .replace(\n            /;function (\\w+)\\((\\w+)\\){/,\n            ';function $1($2){const __props = $2;'\n          )\n          .replace(\n            '\"div\",{',\n            '\"div\",{\"data-post-id\":typeof __props === \"undefined\" ? -1 : __props.queryReference?.pk,'\n          )\n        setBodyStr(newBodyStr)\n      })\n    <\/script>\n  "),I.controller.init());t&&(q(),z(),K(),Y(),J(),X(),A(),M.moduleInterceptor.init(),_.controller.init(),v.controller.init(),f.controller.init())}};const{$utils:Q}=app;M.moduleInterceptor={init:function(){Q.executeScript("\n    <script>\n      const inssist = window.inssist\n      inssist.moduleInterceptor = {\n        getModule,\n        registerModule,\n        registerReduxAction,\n      }\n\n\n      let store\n      const modules = {}\n      const customReduxReducers = []\n      const dispatchListeners = []\n\n\n      function getModule (moduleName) {\n        return modules[moduleName]\n      }\n\n\n      function registerModule (moduleName, module) {\n        if (modules[moduleName]) { return }\n        modules[moduleName] = module\n      }\n\n\n      function registerReduxAction (actionType, reducer) {\n        customReduxReducers.push({ actionType, fn: reducer })\n      }\n\n\n      // add-dispatch-listener\n      registerModule('add-dispatch-listener', (fn) => {\n        dispatchListeners.push(fn)\n      })\n\n\n      // nav\n      // for new bundle version (v2)\n      registerModule('nav', {\n        push (url) {\n          const router = window.require('currentCometRouterInstance')\n          return router.get().dispatcher.go(url)\n        },\n      })\n      // for old bundle version (v1)\n      const _createHref_ = Symbol('createHref')\n      Object.defineProperty(Object.prototype, 'createHref', {\n        get () {\n          return this[_createHref_]\n        },\n        set (value) {\n          delete modules.nav\n          registerModule('nav', this)\n          this[_createHref_] = value\n          return true\n        }\n      })\n\n      // nav-interceptor (used only for v2)\n      //   usage: navInterceptor.beforeGo(prevent, ...args)\n      inssist._beforeGoFns = []\n      inssist._navInterceptorReady = false\n      registerModule('nav-interceptor', {\n        beforeGo (fn) {\n          inssist._beforeGoFns.push(fn)\n        },\n      })\n      inssist.modulePatcher.onModuleInit((bodyStr, setBodyStr) => {\n        if (!bodyStr.includes('._instances')) return\n        if (inssist._navInterceptorReady) return\n        inssist._navInterceptorReady = true\n\n        // patch this code: \"...go:function(a,c){return b(a,null,c)}...\" =>\n        //   \"...go:function(a,c){ <OUR_CODE_HERE>; return b(a,null,c)}...\"\n        const parts = bodyStr.split('go:function')\n        const start = parts[0] + 'go:function' // ...go:function\n        const mid = parts[1].split('{')[0] + '{' // (a,c){\n        const end = parts[1].split('{').slice(1).join('{') // return b(a, null, c)}...\n        const interception =\n          'let args = [...arguments];' +\n          'let prevented = false;' +\n          'let prevent = () => { prevented = true };' +\n          'window.inssist._beforeGoFns.forEach(f => f(prevent, ...args));' +\n          'if (prevented) return;'\n        setBodyStr(start + mid + interception + end, 'nav-interceptor')\n      })\n\n      // http\n      const _AjaxError_ = Symbol('AjaxError')\n      Object.defineProperty(Object.prototype, 'AjaxError', {\n        get () {\n          return this[_AjaxError_]\n        },\n        set (value) {\n          setTimeout(() => {\n            registerModule('http', this)\n            if (this.post) return\n            Object.defineProperty(this, 'post', {\n              get () {\n                return this.post_UNTYPED\n              },\n              set (value) {\n                this.post_UNTYPED = value\n                return true\n              }\n            })\n            Object.defineProperty(this, 'post_DEPRECATED', {\n              get () {\n                return this.post\n              },\n              set () {\n                return true\n              },\n            })\n          })\n          this[_AjaxError_] = value\n          return true\n        }\n      })\n\n      // proxy PolarisInstapi.apiPost to our patched http.post\n      \n      const _createAPICall_ = Symbol('createAPICall')\n      Object.defineProperty(Object.prototype, 'createAPICall', {\n        get () {\n          return this[_createAPICall_]\n        },\n        set (createApiCall) {\n          this[_createAPICall_] = createApiCall\n          setTimeout(() => {\n            if (!modules.http) return\n            Object.defineProperty(this, 'apiPost', {\n              get () {\n                return createApiCall('POST', modules.http.post)\n              },\n              set () {\n                return true\n              },\n            })\n          })\n          return true\n        },\n      })\n\n      // store\n      const _createStore_ = Symbol('createStore')\n      Object.defineProperty(Object.prototype, 'createStore', {\n        get () {\n          return this[_createStore_]\n        },\n        set (createStore) {\n          this[_createStore_] = (reducer, middleware) => {\n            store = createStore((state, action) => {\n              dispatchListeners.forEach(fn => fn(action))\n              const customReducer = customReduxReducers\n                .find(r => r.actionType === action.type)\n              if (customReducer) {\n                return customReducer.fn(state, action)\n              }\n              return reducer(state, action)\n            }, middleware)\n            registerModule('store', store)\n            return store\n          }\n          return true\n        }\n      })\n\n\n      // config\n      const _needsToConfirmCookies_ = Symbol('needsToConfirmCookies')\n      Object.defineProperty(Object.prototype, 'needsToConfirmCookies', {\n        get () {\n          return this[_needsToConfirmCookies_]\n        },\n        set (value) {\n          registerModule('config', this)\n          this[_needsToConfirmCookies_] = value\n          return true\n        }\n      })\n\n\n      // cookies-controller\n      const _getCookie_ = Symbol('getCookie')\n      Object.defineProperty(Object.prototype, 'getCookie', {\n        get () {\n          return this[_getCookie_]\n        },\n        set (getCookie) {\n          registerModule('cookies-controller', this)\n          this[_getCookie_] = (...args) => {\n            const result = getCookie.call(this, ...args)\n\n            // sometimes \"ds_user_id\" is not readable by iframe, idkw.\n            //   to fix this case we try to return \"viewerId\" value of the user state\n            if (args.length === 1 && args[0] === 'ds_user_id' && !result) {\n              let viewerId\n              if (store) {\n                const state = store.getState()\n                viewerId = state && state.users && state.users.viewerId\n              }\n\n              // fallback to any non-empty string to prevent\n              //   isUserLoggedIn function returning false when user is logged in\n              if (!viewerId) {\n                return 'ds_user_id'\n              }\n\n              return viewerId\n            }\n\n            return result\n          }\n          return true\n        }\n      })\n\n\n      // get-stories-context\n      let storiesContext\n      registerModule('get-stories-context', () => storiesContext)\n      const _updateStoriesContext_ = Symbol('updateStoriesContext')\n      Object.defineProperty(Object.prototype, 'updateStoriesContext', {\n        get () {\n          storiesContext = this\n          return this[_updateStoriesContext_]\n        },\n        set (value) {\n          this[_updateStoriesContext_] = value\n          return true\n        },\n      })\n\n\n      // dm-state-proxy\n      const _getThreadSeenByViewer_ = Symbol('getThreadSeenByViewer')\n      Object.defineProperty(Object.prototype, 'getThreadSeenByViewer', {\n        get () {\n          return this[_getThreadSeenByViewer_]\n        },\n        set (value) {\n          registerModule('dm-state-proxy', this)\n          this[_getThreadSeenByViewer_] = value\n          return true\n        }\n      })\n    <\/script>\n  ")}};const{$utils:Z}=app;M.modulePatcher={init:function(){Z.executeScript("\n    <script>\n      window.inssist.modulePatcher = {\n        onModuleInit,\n      }\n\n\n      const fns = []\n\n\n      function onModuleInit (fn) {\n        fns.push(fn)\n      }\n\n\n      // patch __d function so we can modify modules body\n      const _d_ = Symbol('d')\n      Object.defineProperty(Object.prototype, '__d', {\n        get () {\n          const __d = this[_d_]\n          return (...args) => {\n            // __d(moduleFn, moduleId, dependencyIds)\n            const isOldBundleVersion =\n              typeof args[0] === 'function' &&\n              typeof args[1] === 'number' &&\n              Array.isArray(args[2])\n\n            // __d(moduleName, dependencyNames, moduleFn)\n            const isNewBundleVersion =\n              typeof args[0] === 'string' &&\n              Array.isArray(args[1]) &&\n              typeof args[2] === 'function'\n\n            window.inssist.igBundleVersion =\n              isOldBundleVersion ? 'v1' :\n              isNewBundleVersion ? 'v2' : null\n\n            if (!isOldBundleVersion && !isNewBundleVersion) {\n              return __d(...args)\n            }\n\n            const fn = isOldBundleVersion ? args[0] : args[2]\n            const fnStr = fn.toString()\n            const argsStr = fnStr.split('(')[1].split(')')[0]\n            const bodyStartIndex = fnStr.indexOf('{')\n            const bodyEndIndex = fnStr.lastIndexOf('}')\n\n            let debugLabel = null\n            let bodyStr = fnStr.slice(bodyStartIndex + 1, bodyEndIndex)\n            const setBodyStr = (newBodyStr, label) => {\n              bodyStr = newBodyStr\n              debugLabel = label\n              const newFn = new Function(argsStr, bodyStr)\n              if (isOldBundleVersion) {\n                args[0] = newFn\n              } else {\n                args[2] = newFn\n              }\n            }\n\n            fns.forEach(fn => {\n              try {\n                if (isOldBundleVersion) {\n                  fn(bodyStr, setBodyStr)\n                } else {\n                  const moduleName = args[0]\n                  fn(bodyStr, setBodyStr, moduleName)\n                }\n              } catch (e) {\n                console.error(\n                  'failed to patch module',\n                  { debugLabel, e, fn, args, bodyStr }\n                )\n              }\n            })\n\n            return __d(...args)\n          }\n        },\n        set (value) {\n          this[_d_] = value\n          return true\n        },\n      })\n    <\/script>\n  ")}};const{$reels:ee,$utils:te}=app;ee.controller={init:function(){this._forceReelsEnabled()},_forceReelsEnabled:function(){te.executeScript("\n      <script>\n        window.inssist.modulePatcher.onModuleInit((bodyStr, setBodyStr, moduleName) => {\n          if (moduleName !== 'gkx') return\n          const newBodyStr = bodyStr.replace(\n            /(return \\w.result)/,\n            'if (arguments[0] === \"4798\") return true; $1'\n          )\n          setBodyStr(newBodyStr, 'reels-enabled')\n        })\n      <\/script>\n    ")}};const{$utils:ne}=app;let re;O.controller={init:function(){re=p.selectors,document.documentElement.insertAdjacentHTML("afterbegin",`\n    <style>\n      ${re.newPostMenuItem} {\n        order: -1;\n        margin-right: 22px;\n        display: none;\n      }\n    </style>\n  `),ne.executeScript("\n    <script>\n      const modulePatcher = window.inssist.modulePatcher\n      modulePatcher.onModuleInit((bodyStr, setBodyStr) => {\n        if (!bodyStr.includes('MAX_RETRY_IN_MS')) { return }\n        const newBodyStr = bodyStr\n          // old instagram bundle contains \"currentRetryInMs:2*e\"\n          .replace(/currentRetryInMs:\\d\\*\\w/g, 'currentRetryInMs:2500')\n          // new instagram bundle contains \"currentRetryInMs:e*2\"\n          .replace(/currentRetryInMs:\\w\\*\\d/g, 'currentRetryInMs:2500')\n        setBodyStr(newBodyStr, 'retry-upload')\n      })\n    <\/script>\n  ")}};const{$bus:ie,$utils:oe}=app;T.controller={init:function(){!async function(){const e=await ie.send("desktop-reels.get-initial-data");oe.executeScript(`\n    <script>\n      window.inssist.desktopReelsData = ${JSON.stringify(e)};\n    <\/script>\n  `)}()}};const{$bus:se,$utils:ae,$env:ce}=app;se.controller={init:function(){se.on=this._on.bind(this),se.off=this._off.bind(this),se.once=this._once.bind(this),se.send=this._sendSerialized.bind(this),se.sendRaw=this._sendRaw.bind(this),se.sendLocal=this._sendLocal.bind(this),se.getTabId=this._getTabId.bind(this),se.getWindowId=this._getWindowId.bind(this),this._id=`${ce.locus}:${this._generateId()}`,this._skip="__$bus:skip__",this._handlers=[],this._setup()},_getTabId:async function(){if(ce.is.bg)return null;const{tabId:e}=await this._send("bus.getTabData");return e},_getWindowId:async function(){if(ce.is.bg)return null;const{windowId:e}=await this._send("bus.getTabData");return e},_on:function(e,t,n=null){n&&(t=t.bind(n)),this._handlers.push({name:e,fn:t})},_off:function(e,t=null){this._handlers=this._handlers.filter((n=>!!(n.name!==e||t&&n.fn!==t)))},_once:function(e,t){const n=async(...r)=>(this._off(e,n),await t(...r));this._on(e,n)},_sendSerialized:async function(e,...t){return await this._send(e,t,!1)},_sendRaw:async function(e,...t){return await this._send(e,t,!0)},_sendLocal:async function(e,...t){return await this._callHandlers({name:e,args:t,raw:!0})},_send:async function(e,t,n=!1){const r={$bus:!0,raw:n,name:e,args:this._serialize(t,n),senderId:this._id};let i;return ce.is.bg?(r.fromBg=!0,i=await this._sendToTabs(r).then((e=>this._deserialize(e,n)))):(ce.is.pp||ce.is.cs)&&(i=await this._sendToExt(r).then((e=>this._deserialize(e,n)))),i},_setup:function(){ce.is.bg&&chrome.runtime.onMessage.addListener(((e,t,n)=>{var r,i;if(!(!e||!e.$bus))return"bus.getTabData"===e.name?(n({tabId:(null===(r=t.tab)||void 0===r?void 0:r.id)||null,windowId:(null===(i=t.tab)||void 0===i?void 0:i.windowId)||null}),!0):(e.fromBg=!0,this._pick([this._callHandlers(e),this._sendToTabs(e).then((t=>this._deserialize(t,e.raw)))]).then((t=>this._serialize(t,e.raw))).then(n),!0)})),(ce.is.pp||ce.is.cs)&&chrome.runtime.onMessage.addListener(((e,t,n)=>{if(!!!(e&&e.$bus&&e.fromBg))return;if(e.senderId===this._id)return;const r=this._filterHandlers(e);return 0!==r.length?(this._callHandlers(e,r).then((t=>this._serialize(t,e.raw))).then(n),!0):void 0}))},_filterHandlers:function(e){return this._handlers.filter((t=>t.name===e.name))},_callHandlers:async function(e,t=null){if(t||(t=this._filterHandlers(e)),0===t.length)return;const n=await this._deserialize(e.args,e.raw);return await this._pick(t.map((e=>e.fn(...n))))},_sendToExt:async function(e){return await new Promise((t=>{chrome.runtime.sendMessage(e,(e=>{chrome.runtime.lastError?t(void 0):t(e)}))}))},_sendToTabs:async function(e){const t=await ae.callAsync(chrome.tabs.query,{});if(0!==t.length)return await this._pick(t.map((async t=>await new Promise((n=>{chrome.tabs.sendMessage(t.id,e,(e=>{chrome.runtime.lastError?n(void 0):n(e)}))})))))},_generateId:function(){return`${Date.now()}_${Math.random().toString(36).slice(2)}`},_pick:async function(e=[]){let t=0;const n=e.length;return await Promise.race(e.map((e=>new Promise((async r=>{let i;try{i=await e}catch(e){i=void 0,console.error(e)}t+=1,(t===n||ae.is.defined(i)&&!ae.is.null(i))&&r(i)})))))},_serialize:function(e,t=!1){return t?e:this._walkSync(e,(e=>{if(ae.is.blob(e)){return{$bus:!0,type:"blob",url:URL.createObjectURL(e)}}return ae.is.null(e)||ae.is.boolean(e)||ae.is.number(e)||ae.is.string(e)||ae.is.array(e)||ae.is.object(e)?e:this._skip}))},_deserialize:async function(e,t=!1){return t?e:await this._walkAsync(e,(async e=>{if(e&&e.$bus&&"blob"===e.type){return await fetch(e.url).then((e=>e.blob()))}return e}))},_walkSync:function(e,t,n=!1){const r=t(e);if(r===this._skip)return n?this._skip:null;if(e!==r)return r;if(ae.is.array(e)){const n=[];for(let r=0;r<e.length;r++){const i=this._walkSync(e[r],t);n.push(i)}return n}if(ae.is.object(e)){const n={};for(const r in e){const i=this._walkSync(e[r],t,!0);i!==this._skip&&(n[r]=i)}return n}return e},_walkAsync:async function(e,t,n=!1){const r=await t(e);if(r===this._skip)return n?this._skip:null;if(e!==r)return r;if(ae.is.array(e)){const n=[];for(let r=0;r<e.length;r++){const i=await this._walkAsync(e[r],t);n.push(i)}return n}if(ae.is.object(e)){const n={};for(const r in e){const i=await this._walkAsync(e[r],t,!0);i!==this._skip&&(n[r]=i)}return n}return e}};const{$idb:le,$env:de,$bus:ue}=app;le.controller={init:async function(){if(de.is.pp){const e=await this._createDbApi(),t=this._createBusApi();return le.get=e.get,le.set=t.set,le.keys=e.keys,le.clear=t.clear,void(le.remove=t.remove)}if(de.is.bg){const e=await this._createDbApi();return Object.assign(le,e),ue.on("idb.get",e.get),ue.on("idb.set",e.set),ue.on("idb.keys",e.keys),ue.on("idb.clear",e.clear),void ue.on("idb.remove",e.remove)}if(de.is.cs){const e=await this._createDbApi(),t=this._createBusApi();return Object.assign(le,t),void(le.db=e)}},_createDbApi:async function(){const e=new le.Database("inssist",1);return await e.init(),await this._enablePersistentStorage(),{get:e.get.bind(e),set:e.set.bind(e),keys:e.keys.bind(e),clear:e.clear.bind(e),remove:e.remove.bind(e),onChange:e.onChange.bind(e)}},_createBusApi:function(){return{get:e=>ue.send("idb.get",e),set:(e,t)=>ue.send("idb.set",e,t),keys:()=>ue.send("idb.keys"),clear:()=>ue.send("idb.clear"),remove:e=>ue.send("idb.remove",e)}},_enablePersistentStorage:async function(){navigator.storage.persist&&await navigator.storage.persist()}};const pe=(e,t)=>t.some((t=>e instanceof t));let he,me;const fe=new WeakMap,ge=new WeakMap,ye=new WeakMap;let be={get:function(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return fe.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ve(e[t])},set:function(e,t,n){return e[t]=n,!0},has:function(e,t){return e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e}};function _e(e){be=e(be)}function Se(e){return(me||(me=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(Pe(this),t),ve(this.request)}:function(...t){return ve(e.apply(Pe(this),t))}}function we(e){return"function"==typeof e?Se(e):(e instanceof IDBTransaction&&function(e){if(fe.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",o),e.removeEventListener("abort",o)},i=()=>{t(),r()},o=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",o),e.addEventListener("abort",o)}));fe.set(e,t)}(e),pe(e,he||(he=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,be):e)}function ve(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",o)},i=()=>{t(ve(e.result)),r()},o=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",o)}));return ye.set(t,e),t}(e);if(ge.has(e))return ge.get(e);const t=we(e);return t!==e&&(ge.set(e,t),ye.set(t,e)),t}const Pe=e=>ye.get(e);const Ie=["get","getKey","getAll","getAllKeys","count"],Ce=["put","add","delete","clear"],Me=new Map;function xe(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(Me.get(t))return Me.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=Ce.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!Ie.includes(n))return;const o=async function(e,...t){const o=this.transaction(e,i?"readwrite":"readonly");let s=o.store;return r&&(s=s.index(t.shift())),(await Promise.all([s[n](...t),i&&o.done]))[0]};return Me.set(t,o),o}_e((e=>({...e,get:(t,n,r)=>xe(t,n)||e.get(t,n,r),has:(t,n)=>!!xe(t,n)||e.has(t,n)})));const Be=["continue","continuePrimaryKey","advance"],ke={},je=new WeakMap,Oe=new WeakMap,Te={get:function(e,t){if(!Be.includes(t))return e[t];let n=ke[t];return n||(n=ke[t]=function(...e){je.set(this,Oe.get(this)[t](...e))}),n}};async function*Ee(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;t=t;const n=new Proxy(t,Te);for(Oe.set(n,t),ye.set(n,Pe(t));t;)yield n,t=await(je.get(n)||t.continue()),je.delete(n)}function Ae(e,t){return t===Symbol.asyncIterator&&pe(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===t&&pe(e,[IDBIndex,IDBObjectStore])}_e((e=>({...e,get:function(t,n,r){return Ae(t,n)?Ee:e.get(t,n,r)},has:function(t,n){return Ae(t,n)||e.has(t,n)}})));const{$idb:Ne}=app;Ne.Database=class{constructor(e,t){this._db=null,this._name=e,this._version=t,this._changeHandlers=[]}async init(){this._db=await function(e,t,{blocked:n,upgrade:r,blocking:i,terminated:o}={}){const s=indexedDB.open(e,t),a=ve(s);return r&&s.addEventListener("upgradeneeded",(e=>{r(ve(s.result),e.oldVersion,e.newVersion,ve(s.transaction),e)})),n&&s.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),a.then((e=>{o&&e.addEventListener("close",(()=>o())),i&&e.addEventListener("versionchange",(e=>i(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}(this._name,this._version,{upgrade:function(e){e.objectStoreNames.contains("data")||e.createObjectStore("data",{keyPath:"id"})}})}async get(e){const t=await this._db.get("data",e);return null==t?void 0:t.value}async set(e,t){await this._db.put("data",{id:e,value:t}),this._emitChange({type:"set",key:e,value:t})}async keys(){return await this._db.getAllKeys("data")}async clear(){await this._db.clear("data"),this._emitChange({type:"clear"})}async remove(e){await this._db.delete("data",e),this._emitChange({type:"remove",key:e})}onChange(e){this._changeHandlers.push(e)}_emitChange(...e){this._changeHandlers.forEach((t=>t(...e)))}};const{$backup:Re,$bus:$e,$idb:De}=app;Re.controller={init:function(){},_setupMessaging:function(){window.addEventListener("message",(async e=>{const t=e.data;if(!!!(t&&t.$backup&&t.reqId))return;const n=this._handlers.filter((e=>e.name===t.name)),r=(await Promise.all(n.map((async e=>{try{return await e.fn(...t.args)}catch(e){return void Re.error(`handler failed for "${t.name}"`,e)}})))).find((e=>void 0!==e))||void 0;window.top.postMessage({$backup:!0,resId:t.reqId,result:r},"*")}))},_on:function(e,t){this._handlers.push({name:e,fn:t})},_read:async function(){const e=await De.db.keys();if(0===e.length)return null;const t={};for(const n of e)t[n]=await De.db.get(n);return t},_save:async function(e){await De.db.clear();for(const t in e)await De.db.set(t,e[t])},_onChange:async function(e){"set"===e.type?await De.db.set(e.key,e.value):"remove"===e.type?await De.db.remove(e.key):"clear"===e.type&&await De.db.clear()}};const{$startup:Le,$bus:Ve,$env:Fe,$idb:Ue,$backup:He}=app;Le.controller={init:async function(){Fe.controller.init();const e=this._isIgPage(),t=this._isBackupPage();(e||t)&&(await Ve.controller.init(),e&&M.controller.init(),t&&(await Ue.controller.init(),He.controller.init()))},_isIgPage:function(){return location.host.endsWith("instagram.com")},_isBackupPage:function(){return location.href===Fe.backup.url}},Le.controller.init()}();